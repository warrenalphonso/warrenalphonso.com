export const metadata = {
  title: "Investigating the Hubbard model with variational algorithms",
};

# Investigating the Hubbard model with variational algorithms

### A project done through the QC Mentorship program

**Written by Warren Alphonso, advised by Ntwali Bashige.**

Once realized, quantum computers would be an intellectual and engineering
triumph, success in turning Nature's powerful and mysterious laws into
computational power. If our current understanding of quantum mechanics holds up,
it would mean the ability to efficiently simulate _any physical process_.

But it might take decades to build a quantum computer powerful enough to catch
up with classical computers after their 50-year headstart.

A question I've been trying to answer since I started studying quantum computing
concerns its near-term usefulness: <u>what exactly can near-term quantum
computers tell us about the world that our classical physical heuristics
can't</u>? I don't have a great answer yet, but this question is the guiding
principle for the following post.

Most near-term useful work will probably use _variational algorithms_. This
project explores the most well-known of the variational algorithms: the
Variational Quantum Eigensolver (VQE). We'll use the VQE to analyze a fundamental
model in condensed matter physics, the Hubbard model.

You've noticed the length of this post by now.
It is intentional; I've favored a long, winding, wandering, uncertain path
as the search for uses of a quantum computer. Let's get started! [^1]

[^1]:
    _Note to the prospective reader:_ I've done my best to only assume
    you've read the [four essays at QuantumCountry](https://quantum.country/).

Another thing: I don't know much quantum mechanics, so instead of pretending
like things make sense when I don't understand them, I'll explicitly say
["This is true by magic"](https://www.lesswrong.com/posts/kpRSCH7ALLcb6ucWM/say-not-complexity)
as a reminder that we're assuming something without understanding it.

### Table of Contents

[The Hubbard model](#Hubbard-model)

- [A quantum mechanical solid!](#qm-solid)
  - [Why are electrons important?](#electrons)
- [Generalizing to the Hubbard model](#generalize-Hubbard)
  - [Defining creation and annihilation operators](#operators)
- [The Hubbard Hamiltonian](#Hubbard-Hamiltonian)
- [The Jordan-Wigner transformation](#JW)
- [Mott gap](#Mott)

[Exploring the Variational Quantum Eigensolver (VQE)](#VQE)

- [Representing the $2 \times 2$ Hubbard model](#four-site)
- [VQE Primer](#VQE-Primer)
- [The Variational Hamiltonian Ansatz](#VHA)
  - [Adiabatic evolution](#adiabatic)
  - [An ansatz based on adiabatic evolution](#ansatz)
- [Choosing an initial state](#initial)
  - [Position to momentum transformation](#fourier)
  - [The 1D tunneling term](#one-D)
  - [The 2D tunneling term](#two-D)
  - [Choosing the states with best overlap](#overlap)
  - [How _good_ is this ansatz?](#ansatz-quality)
- [Finding the ground state](#ground)

[Uncovering magnetism from the Hubbard model](#magnetism)

- [Spin and magnetism](#spin)
- [Analyzing the ground state](#analyze)

# <span id="Hubbard-model">The Hubbard model</span>

_It is almost like Nature knows you are blatantly cheating, but she gives you a
passing grade anyway._

&mdash; Ntwali Bashige

## <span id="qm-solid">A quantum mechanical solid!</span>

When do we _need_ to use quantum computers to analyze solids?
Quantum computers are based on quantum mechanics, so we can intuit that materials
whose properties and behavior are so _quantum mechanical that we can't hope to
approximate them with classical methods_ will be good candidates for
demonstrating the usefulness of quantum computers.

But what solids fit this description?
From Griffiths' _Introduction to Quantum Mechanics_,

**Problem 1.21:** In general, quantum mechanics is relevant when the de Broglie
wavelength[^2] of the particle in question is greater than the characteristic
size of the system ($d$). In thermal equilibrium at (Kelvin) temperature $T$,
the average kinetic energy of a particle is

$$
\frac{p^2}{2m} = \frac{3}{2} k_B T
$$

(where $k_B$ is Boltzmann's constant $1.380 \times 10^{-23} \mathrm{J \cdot 
K^{-1}}$), so the typical de Broglie wavelength ($\lambda = h / p$) is

$$
\lambda = \frac{h}{\sqrt{3m k_B T}}
$$

where $h$ is Planck's constant $6.626 \times 10^{-34} \mathrm{J \cdot s}$.

<mark>
  The purpose of this problem is to anticipate which systems will *have to be*
  treated quantum mechanically, and which can be safely described classically.{" "}
</mark>

The lattice spacing in a typical **solid** is around $d=0.3 \mathrm{nm}$. Find
the temperature below which the free _electrons_ in a solid are quantum
mechanical. Below what temperature are the _nuclei_ in a solid quantum
mechanical? Use sodium as a typical case. _Moral_: The free electrons in a
solid are _always_ quantum mechanical; the nuclei are almost _never_ quantum
mechanical.

(In a solid the inner electrons are attached to a particular nucleus,
and for them the relevant distance would be the radius of the atom. But the
outermost electrons are not attached, and for them the relevant distance is the
lattice spacing. This problem pertains to _outer_ electrons.)

[^2]:
    We don't know what or why the de Broglie wavelength is useful.
    We just assume that's correct. Treat it like magic.

We want to solve $\lambda > 3 \times 10^{-10} \mathrm{m}$. To do that, we need
to choose some value for
mass $m$ to plug in, so that the inequality is only a function of temperature
$T$. The problem recommends using sodium:

<figure className="flex flex-col items-center">
  <img src="/hubbard/sodium.jpg" alt="Sodium" width="30%" height="auto" />
  <figcaption>
    Sodium is a highly reactive alkali metal.{" "}
    <a href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Na_%28Sodium%29.jpg/220px-Na_%28Sodium%29.jpg">
      Image source
    </a>
    .
  </figcaption>
</figure>

Solving $\lambda > d$:

$$
\frac{h}{\sqrt{3m k_B T}} > 3 \times 10^{-10} \qquad \rightarrow \qquad
\frac{h}{3 \times 10^{-10} \sqrt{3m k_B}} > \sqrt{T} \qquad \rightarrow \qquad
\frac{h^2 \cdot 10^{20}}{9 \cdot 3 m k_B} > T
$$

_Solving for electrons_:

The mass of an electron is $m = 9.109 \times 10^{-31} \mathrm{kg}$. Plugging in
$h$, $m$, and $k_B$, we get
$$T < 1.2935 \times 10^{5} = 129350 \mathrm{K}$$

For some perspective on this result, the surface of the sun is about $6000 
\mathrm{K}$. [Almost](https://www.theatlantic.com/technology/archive/2012/06/humans-create-a-temperature-250-000-times-hotter-than-the-sun-right-here-on-earth/259055/)
everywhere on Earth satisfies the above temperature inequality; the electrons
in sodium _always require_ quantum mechanical treatment.

_Solving for the nucleus_:

Sodium has atomic number 11, which means it has 11 protons. The most common
isotope of Sodium is <sup>23</sup>Na, which has 12 neutrons. Because the mass of an
electron is about a thousand times smaller than the mass of a proton or a
neutron, we'll ignore them when calculating mass. With only protons and neutrons,
our total mass is

$$
3.848 \times 10^{-26} \mathrm{kg}
$$

Plugging in $h$, $m$, and $k_B$, we get

$$
T < 3.062 \mathrm{K}
$$

This temperature is near-zero. The [lowest natural temperature recorded on
Earth](https://en.wikipedia.org/wiki/Lowest_temperature_recorded_on_Earth)
is $184 \mathrm{K}$, so the above inequality is almost never met. The
nucleus can usually be treated with classical methods.

Our takeaway is that <u>outer electrons must be analyzed quantum mechanically
while
nuceli can be well approximated classically</u>. We'll focus on
solids whose outer electrons majorly determine their properties.

### <span id="electrons">Why are electrons important?</span>

It's not clear _why_ we should care about the outer electrons of atoms in a
solid.

But since we want to do something useful with quantum computers that can't be
done with classical computers, this seems like a good thread to follow!

## <span id="generalize-Hubbard">Generalizing to the Hubbard model</span>

The problem we're attacking is: how do the outer electrons in a solid affect
the properties of the entire solid?

We'll need some way to _model_ this problem before we can start making progress.
Let's make some simplifying assumptions:

1. Assume the atoms (nuclei) aren't moving. We can model this as a lattice of fixed
   sites.
   - The mass of an electron is more than a thousand times smaller than the
     mass of a proton. Since the nucleus is made up of protons and neutrons, we're
     justified in thinking only of movement _relative_ to the nucleus, i.e.
     we assume the nucleus is stationary.
2. Assume the atoms only have _one_ electron orbital. The Pauli exclusion
   principle states that each orbital can have a maximum of 2 electrons: a spin-up
   electron and a spin-down electron.
   - This might seem like leap at first, because atoms can have many electron
     orbitals. But because we know that the _outer_ electrons _must_
     be treated quantum mechanically, we may ignore any inner orbitals.
     While there can be multiple outer electron orbitals, we choose to only
     consider one outer orbital. I don't have a great justification for this;
     it'll just make calculations easier if we focus on the simplest case.
3. Assume 2 electrons interact _with each other_ only if they're in the same
   orbital.
   - Interaction strength is determined by proximity: two electrons interact
     very strongly if they're very close. We've decided to only consider the
     strongest interactions.
4. Assume electrons can only hop to another atom if that atom is directly
   adjacent to their current atom.
   - It's easiest and most common for electrons to hop to the nearest orbital,
     so we're only considering these hopping terms.

These 4 assumptions define the _Hubbard model_ of solids. Pictorially, we can
represent the Hubbard model on a 2-dimensional lattice as:

<figure className="flex flex-col items-center">
  <img
    src="/hubbard/2d_hubbard.png"
    alt="Hubbard drawing"
    width="50%"
    height="auto"
  />
  <figcaption>
    <a href="https://arxiv.org/pdf/1811.04476.pdf#page=3">Image source</a>.
  </figcaption>
</figure>

We're making good progress, but we'll need more than a purely visual
understanding of our model.

### <span id="operators">Defining creation and annihilation operators</span>

From our 4 assumptions above, there seem to be 2 main ideas we need to express
about the behavior of free electrons: the _kinetic energy_ of an electron
moving from site to site, and the _potential energy_ of 2 electrons interacting
with each other if on the same site.

Here, I introduce a concept that isn't motivated but extremely useful: the
creation and annihilation operators. These arise from studying the quantum
harmonic oscillator.[^3]

[^3]:
    I recommend [Lecture 8](https://www.youtube.com/watch?v=qu-jyrwW6hw) and
    [Lecture 9](https://www.youtube.com/watch?v=jJX_1zT73U0) of MIT OCW 8.04
    Spring 2013.
